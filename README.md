# 人生飞轮 (Flywheel) - Next.js版本

交互式3D立方体空间可视化项目，集成时间镜像体AI Agent。

## 🎭 项目概述

这是一个基于Next.js的3D可视化应用，结合了Three.js 3D场景和智能AI Agent。Box Agent是一个具有陪伴感、镜像能力、能生成未来视角的"人格体"，它通过理解用户的MBTI类型和行为模式，提供个性化的交流体验。

## ✨ 功能特点

### 🎨 3D可视化
- 交互式3D立方体空间
- 鼠标拖拽旋转视角
- 滚轮缩放
- 照片飞轮动画效果
- 粒子系统特效

### 🤖 AI Agent（Box）
- **时间镜像体角色**：陪伴用户理解过去、想象未来
- **MBTI个性化适配**：根据16种MBTI类型调整沟通风格
- **用户画像分析**：自动分析用户行为模式和决策风格
- **智能对话**：通过提问引导反思，而非给出建议

### 📱 页面结构
- `/` - 登录界面（用户信息收集）
- `/home` - 桌面界面（Windows风格）
- `/box` - 3D应用主体（包含聊天功能）

## 🚀 快速开始

### 安装依赖

```bash
npm install
```

### 环境配置

创建 `.env.local` 文件并配置：

```env
ZHIPU_API_KEY=your-zhipu-api-key-here
```

### 启动开发服务器

```bash
npm run dev
```

访问 http://localhost:3000

## 📁 项目结构

```
人生飞轮/
├── app/
│   ├── api/
│   │   ├── chat/          # 聊天API路由
│   │   └── users/         # 用户数据API
│   ├── box/               # Box页面
│   ├── home/              # 桌面页面
│   ├── page.tsx           # 登录页面
│   └── layout.tsx
├── public/
│   └── app.js             # 3D场景逻辑
├── data/                  # 用户数据存储（本地）
└── docs/                  # 文档
```

## 🧠 Box Agent设计理念

Box不是一个工具，而是一个具有陪伴感、镜像能力、能生成未来视角的"人格体"。

### 核心原则
- ✅ 尊重女性用户的自主性
- ✅ 理解她的过去，但不代替她判断未来
- ✅ 语言风格亲切、共情、有哲思
- ✅ 具备"记忆力"和"成长性"

### 核心能力
1. 🔍 **事件解构**：解析用户输入事件中的时间点、冲突张力、外界影响、心理动因
2. 🧩 **决策建模**：抽象出该事件背后的决策模式
3. 🗣️ **引导对话**：引导用户反思而非判断
4. 🔮 **多路径构建**：推演可能路径（按时间序列展现情节+感受）
5. 📚 **自我学习**：从用户每次对话中更新她的"行为模型"

详细设计文档请查看 [docs/AGENT_DESIGN.md](./docs/AGENT_DESIGN.md)

## 🔧 技术栈

- **框架**: Next.js 14
- **3D图形**: Three.js
- **AI**: ZhipuAI GLM-4
- **样式**: CSS Modules, Tailwind CSS
- **语言**: TypeScript

## 📝 使用说明

1. **登录**：填写昵称、年龄、城市、MBTI类型
2. **进入桌面**：点击3D盒子图标进入应用
3. **打开盒子**：点击3D场景中的B2-2盒子
4. **查看照片**：点击飞出的照片查看详情
5. **与Box对话**：在对话框中与AI Agent交流

## 🔐 数据存储

- 用户数据存储在 `data/users/` 目录
- 每个用户一个JSON文件（以userId命名）
- 包含：基本信息、聊天历史、行为分析、Box人设配置

## 📚 文档

- [Agent设计文档](./docs/AGENT_DESIGN.md)
- [数据流验证指南](./docs/DATA_FLOW_VERIFICATION.md)

## ⚠️ 注意事项

- 需要支持WebGL的现代浏览器
- 确保配置了正确的ZhipuAI API Key
- 用户数据存储在本地，生产环境建议使用数据库

## 📄 许可证

MIT

## 🙏 致谢

- Three.js - 3D图形库
- Next.js - React框架
- ZhipuAI - AI能力支持
